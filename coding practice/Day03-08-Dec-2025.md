## ansible - create user

---
- name: Create Pathnex User
  hosts: all
  become: yes

  tasks:
    - name: Create user pathnex-admin
      shell: /bin/bash




## Terraform - Security Group (r6i.4xlarge EC2)

provider "aws" {
    region = "us-east-1"
}

resource "aws_security_group" "PathnexSG" {
    name = "PathnexSG"
    description = "PathnexSG for SSH"

    ingress {
        from_port = 22
        to_port = 22
        protocol = "tcp"
        cidr_blocks = ["0.0.0.0/0"]
    }
}

resource "aws_instance" "PathnexEC2" {
    ami = "ami-ert9013267544poi"
    instance_type = "r6i.4xlarge"
    vpc_security_group_ids = [aws_security_group.PathnexSG.id]

    tags = {
        Name = "Pathnex-EC2"
    }
}


## kubernetes- Add Environment Variables

apiVersion: v1
kind: Pod
metadata:
  name: pathnex-env-pod
spec:
  containers:
    - name: app
      image: nginx
      env:
        - name: APP_ENV
          value: "production"



## Shell Script--> Check the file exist

#!/bin/bash
FILE="/tmp/pathnex.txt"

if [-f "$FILE" ]; then
  echo "File Exists"
else
  echo "File does not exists"
fi


# NodeJS build
## Jenkins pipeline--> install dependencies, run test and build a NodeJS project    

pipeline {
    agent any
    tools {
        nodejs 'NodeJS-16'
    }
    stages {
        stage('checkout') {
            steps {
                git url: 'https://github.com/Pathnex/sample-node-app.git'
            }
        }
        stage('Install Dependencies') {
            steps {
                sh 'npm install'
            }
        }
        stage('Run Tests') {
            steps {
                sh 'npm test'
            }
        }   
        stage('Build') {
            steps {
                sh 'npm run build'
            }
        }
    }
}


## Gitlab CI--> NodeJS Build

stages:
  - install
  - test
  - build


node-install:
  stage: install
  image: node:16
  script:
    - git clone https://github.com/Pathnex/sample-node-app.git
    - cd sample-node-app
    - npm install

node-test:
  stage: test
  image: node:16
  script:
    - cd sample-node-app
    - npm test

node-build: 
  stage: build
  image: node:16
  script:
    - cd sample-node-app
    - npm run build