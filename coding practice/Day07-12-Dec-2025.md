## Debug Codes Practice --> need to fix the these broken files

# Ansible (Broken)

- name: Install nginx
  hosts: all
  become: yes
  tasks:
    - name: install nginx
      yum:
        name: nginx
        state: present



## Terraform (Broken)

resource "aws_instance" "BrokenEC2" {
  ami = "ami-abc9377dhjsn"
  instance_type = "t2.micro"

  tags = {
    name = "broken"
  }
}


## Kubernetes ( broken )

apiVersion: v1
kind: Pod
metadata:
  name: pathnex
spec:
  containers:
    - name: app
      image: nginx


## Debugging Jenkins Pipeline --> fixing the broken stages and handle error

pipeline {
    agent any
    
    stages {
      stage('checkout') {
        steps {
          git branch: 'main' , url: 'https://github.com/Pathnex/sample-java-app.git'  
        }
      }
      stage('build') {
        steps {
          sh '''
          mvn clean compile || { echo "compile failed"; exit 1; }
          '''
        }
      }
      stage('Test') {
        steps {
          sh ''' 
          mvn test || { echo "tests failed"; exit 1; }
          '''
        }
      }
    }
}


## GitLab CI --> Debugging 

stages:
  - Build
  - test

build:
  stage: build
  image: maven:3.8.1-jdk-17
  script:
    - git clone https://github.com/Pathnex/sample-java-app.git
    - cd sample-java-app
    - mvn clean compile ||  { echo "compile failed"; exit 1; }

test:
  stage: test
  image: maven:3.8.1-jdk-17
  script:
    - cd sample-java-app
    - mnv test || {echo "Test failed"; exit 1; }