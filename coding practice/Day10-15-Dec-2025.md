# Day 10  Conditions, Route Table, Secret, Loops
## --> Ansible — When Condition

---
- name: Install tool based on OS
  hosts: all
  become: yes

  tasks:
    - name: Install htop
      yum:
        name: htop
        state: present
      when: ansible_facts['os_family'] == "RedHat"    # thats mean if OS is redhat then only run it otherwise skip it 




## --> Terraform — Route Table + Association

resource "aws_route_table" "PathnexRoute" {
  vpc = aws_route_table.PathnexRoute.id

  route {
    cidr_block = "0.0.0.0/0"
    gateway_id = aws_internet_gateway.pathnexIGW.id
  }

  tags = {
    name = "Pathnex-Route"
  }
}
resource "aws_route_table_association" "PathnextRouteAssociation" {
  subnet_id = aws_subnet.PathnexSubnet.id
  route_table_id = aws_route_table.PathnexRoute.id
}


##  Kubernetes —> Secret

apiVersion: v1
kind: Secret
metadata:
  name: Pathnex-Secret
type: opaque
data:
  password: dkshjclsk== # "pathnex123" base64





## Shell Script — For Loop 1–10

#!/bin/bash
for i in {1..10}; do
  echo "Number: $i"
done


# Caching Dependencies

## --> Jenkins Pipeline — Cache Maven Dependencies

pipeline {
    agent any
    environment {
        INSTITUTE_NAME = "Pathnex"
    }
    stages {
        stage('Checkout') {
            steps {
                git url: 'https://github.com/Pathnex/sample-java-app.git'
            }
        }
        stage('Build') {
            steps {
                sh '''
                if [ -d ".m2" ]; then
                    echo "Using cached dependencies"
                else
                    mvn clean compile
                fi
                '''
            }
        }
    }
}




## --> GitLab CI — Cache Dependencies

stages:
  - build

build:
  stage: build
  image: maven:3.8.1-jdk-17
  cache:
    key: maven-cache
    paths:
      - .m2/repository
  script:
    - git clone https://github.com/Pathnex/sample-java-app.git
    - cd sample-java-app
    - mvn clean compile